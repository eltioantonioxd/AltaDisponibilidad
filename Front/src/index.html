<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chile today </title>
    <link rel="shortcut icon" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAARMAAAC3CAMAAAAGjUrGAAAAk1BMVEXVKx7///
    8SJWLTGADrq6kAF1zaKxp9gp2MKEUAJGQAAFbQ094AAFQAAFIAGl0PI2HHy9kAHV6AiKcADVgAElrj5e0AFVtzfJ16haljbZK4vc4ACVv3+PtveJtbZY1pc
    5dTXom8wdGts8bs7vQ5R3oyQXYqOW+mrMKborqNlLAfMWzb3udcZ48AAEsWK2hATX2sXWrG4+1tAAACrklEQVR4nO3a21LaUBSAYfZuaUuOhGORWBAEBKz0/Z+uk
    AkgLMIOnXLByv9dYpYz/OOSZGvN3k39u3lMNZoINJFoItFEoolEE4kmEk0kmkg0kWgi0USiiUQTiSYSTSSaSDSRaCLRRKKJRBPptiYRTcS7/Fmnyak4MR5Nzt5k3w
    xu2J5KNPGa5mlIkxNDY9IblqcKTaLn7fW/Epp8sl0dc8vyVKFJe3d96sU0OYhG2cC49PJUoIn3kg1M2jQ5NkmzgWlAk71okE+UXh79TYZP+cSi7PLob5Kvzg3Lo69JHHifhe
    PDyGt48pVh0Yezuibxxj81PYx0z74yK4iiromNZt1S32A9L/qdq6+JTYJFifm3sPBjSGETa4P31DGdjq88J6tsYuuRf3W42bl2xKSziY3D5ZXZVnj1eVBpk+2t2mZaMNmdOW7e1DaxyeEG9tTEc93j622y3Z/nC3MD992s4ibWdlbntyrrRs89prqJDUW
    TsMSU6ibJqxhblTiBVN2k/SbGllXfnUA++axLHBhobhLPLsw13MujuUnnuDrHW/2We3k0NwnX+bXp++/Rfs6v9P1JPM8v9ZO67X3sA7mXR3GTTv4YuMye+JIg36SW899zFDcJsp+M6Sb/Q3HsjbNTFd/5HwZ6m8Sr3WUvw+MTX1Tf/THd9FzLo7dJb7c6/ZOTkjhs7V5zLY/eJoFv1vP
    O2YvtWdc0Xcujtkn8YRaBPClJvImJHMujtknUHwQX33vQHzkOldQ2sUnRMXRU4XO2f0YTmtCEJjShiUATiSYSTSSaSDSRaCLRRKKJRBOJJhJNJJpINJFoItFEoolEE4kmEk2kWuNueg/b5Mf9/Pn6mGrf7ujLY6oBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD8J38Bk6qkwjDByP8AAAAASUVORK5CYII=" />

    <link href="css/style.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
</head>

<body>
    <script src = "https://www.tutorialspoint.com/jquery/jquery-3.6.0.js"></script>
    <nav></nav>
    <main class="container">
      <div>
            <div class="row">
                <div class="col-9 left">
                    <div class="row top">
                        <div class="col">Región Metropolitana</div>
                        <div class="col day"></div>
                        <div class="col">Santiago, Chile</div>
                    </div>
                    <div class="row">
                        <div class="col-7 temp temperatura"></div>
                        <div class="col-5 time"><p id="hora-actual"></p><h2><b id="dia-actual">Jueves</b></h2></div>
                    </div>
                    <div class="bottom">                        
                        <div class="row text-center">
                            <div class="col-6 h5">Min:
                              <div class="temp-min"><b></b></div>
                            </div>
                            
                            <div class="col-6 h5">Max:
                              <div class="temp-max"><b></b></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-3">
                    <div class="row top">Previsión del tiempo por horas</div>
                    <div class="timely hoursDay">
                    </div>
                </div>
            </div>
    </div>
    <section class="container mt-5 ml-0">
          <div class="row">
             <div class="col-6">
              <div class="card border-0">
                <div class="card-body">
                  <h3 class="card-title text-primary">Valor Dólar Hoy</h3>
                  <p class="day">Valor del dia: </p>
                  <hr>
                  <h4 class="dollar"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a4/Flag_of_the_United_States.svg/1024px-Flag_of_the_United_States.svg.png"
                    width="40"> USD → $ </h4>
                  <hr>
                  <p class="lead dollar-2">$ 1 dólares = $ </p>
                </div>
              </div>
             </div> 

             <div class="col-6">
              <div class="card border-0">
                <div class="card-body">
                  <h3 class="card-title text-success">Valor UF Hoy</h3>
                  <p class="day">Valor del dia: </p>
                  <hr>
                  <h4 class="uf">1 UF → </h4>
                  <hr>
                  <p class="lead uf">$ 1 unidad(es) de fomento = </p>
                </div>
              </div>
             </div> 
  
          </div>
    </section>
  </main>
  <footer>

  </footer>
    <script type = "text/javascript">
        function showTime(){
          myDate = new Date();
          hours = myDate.getHours();
          minutes = myDate.getMinutes();
          seconds = myDate.getSeconds();
          if (hours < 10) hours = 0 + hours;

          if (minutes < 10) minutes = "0" + minutes;

          if (seconds < 10) seconds = "0" + seconds;

          $("#hora-actual").text(hours+ ":" +minutes+ ":" +seconds+ getAMPM(myDate));
          setTimeout("showTime()", 1000);
        }
        showTime();

        function getAMPM(dateObj) {
          return dateObj.getHours() < 12 ? ' am' : 'pm';
        }

        const weekday = ["Domingo","Lunes","Martes","Miércoles","Jueves","Viernes","Sabado"];

        const d = new Date();
        let day = weekday[d.getDay()];
        document.getElementById("dia-actual").innerHTML = day;

        $(document).ready(function () {  

            function date(data){
                let date = new Date();
                let hour = date.getHours();
                let aux = [2,5,8,11,14,17,20,23]
                for(let i=0; i<aux.length; i++){
                    if(aux[i] == hour){
                        return data[i]
                    }
                    else if(hour < aux[i]){
                        return data[i]
                    }
                }
            }

            function minMax(data){
              let arrAux = []
              for(let i=0; i<data.length; i++){
                let value = parseInt(data[i])
                arrAux.push(parseInt(data[i]))
              }

              let temp_min = Math.min(...arrAux)
              let temp_max = Math.max(...arrAux)
              let temp_min_max = [temp_min, temp_max]

              return temp_min_max
              
            }

            function hourstemp(hours, temp){
              for(let i=0; i<hours.length; i++){
                html = `
                <div class="mb-4 text-center">`+hours[i]+`&nbsp; <b>`+temp[i]+`C</b></div>
                `
                $('.hoursDay').append(html)
                  console.log(hours[i])
              }
            }

            $.ajax({  
                type: "GET",  
                url: "http://localhost:5000/temperature",    
                dataType: "json", 
                success: function (data, statusText, jqXHR) {  
                    $('.day').append(data.day)
                    console.log(data)
                    $('.temperatura').append(date(data.temp)+'C')

                    console.log(data.temp)
                    let min_max = minMax(data.temp)
                    $('.temp-max').append(min_max[1]+'°C')
                    $('.temp-min').append(min_max[0]+'°C')
                    hourstemp(data.hours, data.temp)
                },   
            });    
            
            
            $.ajax({  
              type: "GET",  
              url: "http://localhost:5000/dollar",    
              dataType: "json", 
              success: function (data, statusText, jqXHR) {  
                  $('.dollar').append(data.dollar+` <img src='https://cdn.pixabay.com/photo/2012/04/11/17/47/chile-29125_640.png' width="40">`)
                  $('.dollar-2').append(data.dollar+` pesos chilenos`)
                },   
          });   
          
          $.ajax({  
            type: "GET",  
            url: "http://localhost:5000/uf",    
            dataType: "json", 
            success: function (data, statusText, jqXHR) {  
                $('.uf').append(data.uf)
              },   
        });
          
       }); 
    </script>

    
</body>
</html>